✅ 1. 개발 목적
AI 기반 상담 훈련 플랫폼 구축
상담 교육 훈련에 필요한 실시간 AI 내담자 시뮬레이션 기능을 제공하여, 훈련생(상담자)의 의사소통 기술, 공감 능력, 진단 역량을 효과적으로 향상시키는 것을 목표로 함.

LLM 기반 정교한 피드백 자동화
상담 장면의 STT, 감정 추출, Annotated Transcript, 시나리오 기반 피드백, 상담이론 분석을 AI가 자동으로 수행함으로써 전문성과 일관성을 갖춘 피드백 제공.

민감한 개인정보 보호 구조 구현
상담 대화 중 포함될 수 있는 개인정보와 일반 정보를 구분하여 처리하고, 암호화 저장 및 LLM 비전송 방식을 통해 AI 상담 시스템의 신뢰성 확보.

🎯 2. 개발 목표
구분	세부 목표
플랫폼	Electron 기반 데스크탑 앱으로 구현. Windows/macOS에서 설치 가능
실시간 대화	마이크 입력 → 실시간 STT → LLM 응답 → TTS 음성 출력까지 2초 이내 응답
가상 내담자	5개 이상의 AI 내담자 캐릭터 제공 (성격, 감정, 상담 주제 등 프롬프트 기반 설정 가능)
하이브리드 LLM	서칭형 LLM(온디바이스, 예: Gemma, Mistral) + API형 LLM(GPT-4o 등) 병렬 사용
피드백 자동화	대화 후 스크립트 기반 주석, 체크리스트, 고급기술, 요약, 이론 분석 피드백 자동 생성
타임라인 동기화	STT 결과 + 영상 녹화 데이터 동기화 → 스크립트 클릭 시 해당 영상 구간으로 이동
데이터 보호	개인정보 암호화 저장 + 비PII만 LLM 처리 → 보안·윤리 문제 해결
확장성	LLM 교체 및 모듈형 구조 설계 (LangChain 등 도입), LMS 연동 및 시나리오 확장 고려

📦 3. 최종 구현 산출물
카테고리	산출물 설명
① 사용자 앱 (Electron)	- 실시간 상담 시뮬레이션 기능
- AI 내담자 선택 및 인터랙션
- 상담 중/후 자동 피드백 UI
- 캠+마이크 입력 기반 녹화 및 시청 기능
② 백엔드 시스템 (FastAPI)	- 사용자 인증 및 세션 관리 API
- Whisper 기반 STT 및 TTS 처리
- LLM 응답 API 및 평가 체인 구성
- 영상/스크립트/피드백 저장 관리
③ 하이브리드 LLM 모듈	- 로컬 LLM 구성 (vLLM, Gemma 등)
- GPT-4o, Claude API 연동 인터페이스
- LangChain 기반 피드백 평가 체인
- 이론 분석 및 감정 흐름 추론 기능 포함
④ 데이터 보안 구성	- PII 항목 분류 및 암호화 로직
- LLM 전달 필드 필터링 구조
- 관리자 권한/접근 로그 기록 기능
⑤ 피드백 리포트 시스템	- Annotated Transcript 생성기
- 평가체크리스트 자동 점수화
- 세션 요약 + 상담 이론 분석
- PDF 리포트 및 내보내기 기능
⑥ 관리자용 대시보드	- 세션 이력, 상담자별 피드백 조회
- 캐릭터 설정, 평가 기준 커스터마이징
- 모델 설정/전환 기능 및 모니터링 도구
⑦ 기술 문서 및 가이드	- 전체 시스템 기획서/기능 명세서
- 백엔드 API 문서(Swagger 포함)
- 운영 가이드 및 보안 정책 설명서
- LLM 프롬프트/체인 구성 가이드


이 리스트는 Electron 기반 클라이언트, FastAPI 백엔드, 하이브리드 LLM 구조, 개인정보 보호 구조(암호화/비암호화 분리), 상담 시뮬레이션 및 피드백 자동화 기능 등을 통합적으로 반영하여 설계되었습니다.

✅ 전체 개발 목표 요약
플랫폼: Electron 기반 데스크탑 앱

백엔드: FastAPI

LLM 구조: 서칭형 LLM (예: Gemma 2, Mistral) + 외부 API형 LLM (예: GPT-4o, Claude) 하이브리드

데이터 보호: 민감정보(PII)는 클라이언트/서버단에서 암호화 후 처리, 일반 정보는 LLM 처리

대상 기능: 상담 시뮬레이션, STT/TTS, AI 피드백, Annotated Transcript, 감정 분석 등

🧠 설계 및 아키텍처 TODO
1. 기술 아키텍처 정의
 Electron + Vue/React 기반 프론트 구조 설계

 FastAPI 백엔드 API 스펙 정의 (REST or WebSocket)

 LLM 인터페이스 구조 설계 (API형, 온디바이스형 vLLM 동시 활용)

 STT/TTS 모듈 통합 구조 설계 (Whisper, Coqui, ElevenLabs, Azure TTS 등)

 데이터 암호화 정책 수립 (PII 항목 식별 → 암호화/비암호화 분리 처리)

 WebRTC + MediaRecorder 기반 캠/음성 스트리밍 구조 설계

 LLM 프롬프트 구조 및 피드백 체인 설계 (LangChain or Custom)

🧩 프론트엔드 TODO (Electron 기반)
2. 기본 구조 구축
 Electron 앱 생성 (main/renderer 분리)

 사용자 로그인 및 사용자 유형(훈련생/관리자) 구분

 Google 로그인 연동 (OAuth2, 토큰 처리)

3. 주요 기능 UI 구현
 상담 캐릭터 선택/생성 UI (캐릭터 정보, 감정 상태, 태그 검색 등)

 상담 세션 화면: 마이크 입력 + 음성 스트리밍 UI

 사용자 캠 화면 + 녹화 UI (MediaRecorder)

 대화 스크립트 타임라인 UI (ReactPlayer, D3.js 활용 가능)

 실시간 STT 출력 UI 및 감정 상태 표시 (표정 or 아이콘)

 상담 종료 후 피드백 뷰어 (피드백 주석, 하이라이팅, 리포트 등)

 암호화된 개인정보 UI 시각화 및 보호 상태 표시

 관리자용 세션 관리 및 리포트 대시보드

🧱 백엔드 TODO (FastAPI 기반)
4. FastAPI 서버 구축
 사용자 인증 처리 (OAuth + JWT)

 세션 생성/저장/불러오기 API

 WebSocket 기반 음성 실시간 처리 API

 STT 처리 엔드포인트 (Whisper/Google STT)

 TTS 요청 처리 API (ElevenLabs, XTTS 등)

 LLM 응답 생성 API (vLLM + OpenAI API 통합)

 암호화된 사용자 정보 저장 처리

 녹화 파일 및 음성 파일 저장 (S3/local 선택)

🔐 개인정보 보호 TODO
5. 민감 정보 보호 및 암호화
 개인정보 필드 분류 (ex. 이름, 나이, 병력 등)

 PII 항목은 AES 또는 동형암호 방식으로 처리

 STT/LLM 입력 시 비PII 항목만 전달되도록 처리

 암호화 상태 시각화 및 관리자 접근 로그 기록

 민감 정보 로그 접근 시 관리자 2차 인증 구성

🧠 AI 기능 및 LLM 연동 TODO
6. LLM 기능
 서칭형 LLM (예: Gemma3-12b or Mistral 7B) 온디바이스 구축

 GPT-4o or Claude API 연동 및 토큰 정책 적용

 PromptTemplate 설계 (감정반영, 공감, 질문 등 자동 피드백)

 LangChain 기반 피드백 체인 구성 (LLMChain + Tool + Memory)

7. 피드백 자동화 기능
 Annotated Transcript 생성기 (LLM 응답 기반 타임스탬프 주석)

 Evaluation Checklist 자동 점수화

 Strength / Area to Improve / Recommendation 자동 요약

 상담 이론 적용 자동 분석 (CBT 등 키워드 매핑 기반)

 감정 흐름 시각화 (LLM 감정 추출 or Emotion Classifier 활용)

🔁 음성 및 녹화 시스템 TODO
8. 음성 및 영상 처리
 실시간 STT: Whisper or Google STT 연동

 실시간 TTS: ElevenLabs, Bark, Azure TTS 연동

 감정 기반 음성 톤 선택 및 적용

 MediaRecorder 기반 캠 + 마이크 영상 동기 녹화

 STT 결과와 캠 타임코드 동기화

 클릭 가능한 스크립트 UI ↔ 영상 위치 동기화

📊 세션 관리 및 리포트
9. 세션 이력 관리 및 리포트
 세션별 대화 저장 구조 (JSON + timestamp)

 세션 리포트 자동 생성 (피드백, Annotated, 요약 포함)

 리포트 PDF 출력 및 다운로드 기능

 관리자용 피드백 열람/수정/승인 UI

 세션별 캐릭터, 주제, 감정 히스토리 기록

🔄 기타/운영 기능
10. 운영 및 확장 기능
 LLM 비용 최소화를 위한 캐싱, 평가 지연 처리

 전처리된 Prompt 캐싱 및 LRU 메모리 정책 구현

 LMS 연동 기능 (Canvas, Moodle 등)

 로컬 모델과 API형 모델 동적 선택 구조 구현

 플러그인 기반 감정모델 / 상담이론 확장 설계

🚀 향후 확장 고려사항
 시나리오 기반 질병 경과 시뮬레이션 모듈

 사용자별 성과 분석 대시보드

 모바일 지원 고려 (Capacitor or WebRTC 기반)

 논문 자동 연동 기반 이론 피드백 (LLM+search hybrid)




YATAV 상담훈련용 서비스 기술 명세서
==============================

1. 개요
--------
YATAV 상담훈련용 서비스는 AI 기반의 가상 내담자와 상호작용하며 상담자의 기술을 향상시키는 목적으로 개발된다. 본 서비스는 Electron 기반의 데스크탑 앱과 FastAPI 백엔드로 구성되며, 하이브리드 LLM 구조와 개인정보 보호 체계를 포함한다.

2. 기술 스택
-------------
- 클라이언트: Electron + Vue.js 또는 React.js
- 백엔드: FastAPI (Python)
- 데이터베이스: MongoDB, Redis
- STT: Whisper, Google STT
- TTS: ElevenLabs, Coqui XTTS, Azure TTS
- LLM: GPT-4o, Claude API, Gemma, Mistral (vLLM)
- 기타: LangChain, WebRTC, MediaRecorder API, ReactPlayer, D3.js

3. 주요 기능
-------------
[1] 실시간 상담 시뮬레이션
  - 마이크 입력(STT), 실시간 응답(LLM), 음성 출력(TTS)
  - 전체 응답 지연 2초 미만
  - 감정 인식 및 반영

[2] AI 내담자 캐릭터
  - 캐릭터별 성격, 감정, 음색 설정
  - 프롬프트 기반 캐릭터 커스터마이징
  - 태그 기반 캐릭터 검색 기능

[3] 개인정보 보호
  - 민감정보는 AES 또는 동형암호화 적용
  - LLM 처리 시 비PII만 전달
  - 관리자 접근 기록 및 시각화

[4] 자동 피드백 시스템
  - Annotated Transcript 생성
  - Strength / Improve / Recommend 요약
  - 상담 이론 분석 (CBT, Client-Centered 등)
  - 감정 흐름 시각화

[5] 타임라인 동기화 UI
  - 캠 녹화와 스크립트 연동 (MediaRecorder + STT timestamp)
  - 스크립트 클릭 → 영상 구간 이동

[6] 관리자 기능
  - 세션 이력, 피드백 검토 및 승인
  - 사용자 활동 로그, 캐릭터 설정 관리

4. 보안 및 개인정보 처리
-------------------------
- PII 항목 분리 및 암호화 저장
- 비PII 항목만 LLM 전송
- 관리자 접근 시 2차 인증 적용 가능
- 민감 정보와 일반 정보 구분 시각화

5. 시스템 아키텍처
-------------------
- Electron 앱 (클라이언트)
- FastAPI 서버 (API 처리 및 LLM 연동)
- LLM 하이브리드 처리 모듈 (vLLM + OpenAI API)
- DB 저장소: MongoDB (세션), Redis (RAG 캐시)
- 클라이언트 <-> 서버 간 WebSocket + REST 혼합 통신
- 녹화 및 음성 파일은 S3 또는 로컬에 저장

6. 향후 확장 계획
-------------------
- 시나리오 기반 질병경과 시뮬레이션
- LMS 연동 (Canvas, Moodle 등)
- 모바일 버전 개발 (Electron Capacitor 고려)
- 다국어 지원 및 학습용 AI 피드백 확장

// 개발을 위해 추가해야 할 작업 (DevPlan.txt 분석 기반)
📝 추가 개발 작업 목록
1. Phase 1 보완: Docker 환경에 Redis 캐싱 추가 설정
2. Phase 2 보완: WebRTC를 활용한 P2P 음성 스트리밍 기능 테스트
3. Phase 3 보완: LLM 프롬프트 최적화 및 A/B 테스트
4. Phase 4 보완: 피드백 리포트에 사용자 맞춤형 추천 기능 추가
5. Phase 5 보완: CI/CD 파이프라인 구축 (GitHub Actions)
6. 전반적: 단위 테스트 및 통합 테스트 스크립트 작성 (tests/ 디렉토리 활용)
7. 보안 강화: OWASP 기반 취약점 스캔 및 수정
8. 성능 최적화: LLM 응답 시간 모니터링 및 캐싱 레이어 추가
9. 문서화: API 엔드포인트별 사용 예시 코드 추가 (docs/ 디렉토리)
10. 확장성: 모듈형 구조로 LLM 교체 용이하게 리팩토링




📱 주요 UI 컴포넌트

  1. 메인 앱 컨테이너

  - frontend/src/EnterpriseApp.js - 엔터프라이즈 앱 메인 컨테이너
  - frontend/src/SimpleApp.js - 심플 앱 메인 컨테이너
  - frontend/src/simple.js - 앱 진입점

  2. 스타일시트 (CSS)

  - frontend/src/EnterpriseApp.css - 엔터프라이즈 앱 스타일
  - frontend/src/SimpleApp.css - 심플 앱 스타일
  - frontend/src/TrainingPrograms.css - 훈련 프로그램 공통 스타일 (Apple 디자인)
  - frontend/src/TrainingHub.css - 훈련 허브 스타일
  - frontend/src/SessionView.css - 세션 뷰 스타일
  - frontend/src/ApiKeySettings.css - API 키 설정 모달 스타일

  3. 훈련 프로그램 UI

  - frontend/src/BasicCounselingTraining.js / .css - 기본 상담 훈련 UI
  - frontend/src/CrisisInterventionTraining.js / .css - 위기 개입 훈련 UI
  - frontend/src/SpecificTechniquesTraining.js / .css - 특정 기법 훈련 UI
  - frontend/src/TherapyTechniquesTraining.js / .css - 치료 기법 훈련 UI

  4. 세션 관련 UI

  - frontend/src/SessionView.js - 상담 세션 뷰
  - frontend/src/ScenarioSelection.js / .css - 시나리오 선택 UI
  - frontend/src/ScenarioSession.js / .css - 시나리오 세션 UI

  5. 유틸리티 컴포넌트

  - frontend/src/ApiKeySettings.js - API 키 설정 모달
  - frontend/src/TrainingHub.js - 훈련 허브 대시보드
  - frontend/src/icons.js - 모노크롬 SVG 아이콘 라이브러리

  🎨 디자인 시스템 특징

  Apple 스타일 디자인

  - TrainingPrograms.css에 정의된 공통 디자인 시스템
  - 미니멀하고 깔끔한 인터페이스
  - 모노톤 아이콘 사용 (grayscale 필터)
  - 절제된 색상 팔레트:
    - Primary: #1d1d1f (검정)
    - Secondary: #86868b (회색)
    - Background: #f5f5f7 (연한 회색)
    - Accent: #007aff (파랑)

  주요 UI 패턴

  1. 카드 레이아웃: .content-card, .module-card
  2. 프로그레스 바: .progress-bar, .progress-fill
  3. 배지 시스템: .badge, .badge-success, .badge-danger
  4. 모달 오버레이: .modal-overlay, .api-key-modal
  5. 사이드바 네비게이션: .enterprise-sidebar, .sidebar-nav

  반응형 디자인

  - 모바일, 태블릿, 데스크톱 대응
  - 브레이크포인트: 768px, 1024px
  - 사이드바 축소/확장 기능

  애니메이션

  - fadeIn, slideUp, slideIn 효과
  - 부드러운 전환 효과 (transition: 0.2s-0.3s)
  - 호버 효과 및 클릭 피드백

  접근성 고려사항

  - 명확한 색상 대비
  - 키보드 네비게이션 지원
  - 아이콘과 텍스트 레이블 병행 사용
  - 다크모드 지원 (@media (prefers-color-scheme: dark))

  이 파일들을 수정하면 앱의 UI/UX를 변경할 수 있습니다.



=======================================

이름, 성별, 생년월일
학력 / 결혼상태 / 상담 및 검사경험 / 현재의 어려움 / 가족관계 / 심리검사결과 / 
상담받고 싶은 부분
-개인문제(성격고민, 신체질병 및 건강, 삶의 의미와 목표, 대인관계, 종교적문제)
-가족문제(가족갈등, 배우자 정신건강)
-정신건강(우울, 불안, 무기력, 짜증분노, 불면, 강박, 공황장애,PTSD)
-중독(흡연, 알코올, 도박)
-위기(자살, 자해, 타인위해)
- 직업 상태: 취업 or 학생 여부
- 사회적 지지망: 친구, 가족 등 지지 자원 여부 (인테이킹 시 가까운 사람의 번호를 쓰는 것과 비슷한 맥락)
- 의학적 상태: 주요 신체 질환, 복용 약물 (정신과 약 포함)
- 목표/기대: 상담을 통해 얻고 싶은 구체적 목표가 있는지?

=======================================

심리상담에서 가장 흔히 만나게 되는 대표적인 내담자 유형 10가지를 소개해드리겠습니다.

## 주요 내담자 유형

### 1. **우울/무기력형**
- 지속적인 우울감, 의욕 저하, 절망감을 호소
- "삶의 의미를 찾을 수 없어요", "매일이 힘들어요" 등의 표현
- 수면장애, 식욕부진, 집중력 저하 동반

### 2. **불안/걱정형**
- 과도한 걱정, 불안감, 공황발작 경험
- 미래에 대한 두려움이 크고 최악의 상황을 상상
- 신체적 증상(두근거림, 호흡곤란 등) 동반

### 3. **대인관계 어려움형**
- 타인과의 관계 형성 및 유지에 어려움
- 사회적 위축, 대인기피, 소통 문제 호소
- "사람들이 나를 싫어할 것 같아요" 등의 인지왜곡

### 4. **분노조절 어려움형**
- 감정 조절 능력 부족, 충동적 행동
- 작은 일에도 과도하게 화를 내거나 폭발적 반응
- 이후 죄책감과 후회 반복

### 5. **자존감 저하형**
- 자기 가치감 부족, 열등감 심화
- 완벽주의 성향으로 인한 자기비판
- "나는 아무것도 잘하는 게 없어요" 등의 부정적 자기평가

### 6. **트라우마/PTSD형**
- 과거 충격적 경험으로 인한 지속적 고통
- 플래시백, 악몽, 회피행동 나타남
- 일상생활 기능 저하 및 재경험 증상

### 7. **중독/의존형**
- 알코올, 약물, 게임, 도박 등 각종 중독 문제
- 조절 능력 상실과 일상생활 파괴
- 부인과 합리화 기제 강함

### 8. **가족/부부갈등형**
- 가족 내 갈등, 부부관계 문제, 자녀 양육 스트레스
- 의사소통 단절, 역할 갈등, 가치관 차이
- 관계 개선 및 소통 방법 모색

### 9. **진로/적응 고민형**
- 학업, 진로, 직장 적응 등 발달과업 관련 어려움
- 정체성 혼란, 미래 불안, 선택의 어려움
- 특히 청소년, 대학생, 사회초년생에게 흔함

### 10. **신체화/건강염려형**
- 심리적 스트레스가 신체 증상으로 나타남
- 원인 불명의 신체 증상 지속, 건강에 대한 과도한 걱정
- 의학적 검사에서 이상 없으나 주관적 고통 심함

## 상담 접근 시 고려사항

각 유형별로 **적절한 상담 기법과 접근 방식**이 다르며, 내담자의 개별적 특성과 상황을 종합적으로 고려해야 합니다. 또한 한 사람이 여러 유형의 특성을 동시에 보이는 경우도 많아 **통합적 관점**에서의 이해가 중요합니다.

상담자는 이러한 유형별 특성을 이해하되, 고정된 틀에 갇히지 않고 각 내담자의 **고유한 경험과 맥락**을 존중하며 접근하는 것이 바람직합니다.

